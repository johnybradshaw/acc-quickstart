# acc-quickstart

## Overview

Quick deployment of services on Akamai Connected Cloud

<!-- BEGIN_TF_DOCS -->
<!-- The module-name will be auto generated by the script -->
# acc-quickstart

This deploys *n* number of Virtual Machines (Linodes) on Akamai Connected Cloud, it also registers them in the DNS zone and applies a cloud-init to them.

## Important

The readme.md has the following sections:

- Requirements - Min requirements for the module to run
- Providers - Providers required by the module
- Inputs- Inputs to the module
- Outputs - Outputs from the module
- Usage - How to use the module

#### Requirements

The following requirements are needed by this module:

- <a name="requirement_terraform"></a> [terraform](#requirement_terraform) (>= 1.5.7)

- <a name="requirement_cloudinit"></a> [cloudinit](#requirement_cloudinit) (>=2.3.3)

- <a name="requirement_linode"></a> [linode](#requirement_linode) (>= 2.9.3)

- <a name="requirement_random"></a> [random](#requirement_random) (>=3.1.0)

#### Providers

The following providers are used by this module:

- <a name="provider_cloudinit"></a> [cloudinit](#provider_cloudinit) (2.3.3)

- <a name="provider_linode"></a> [linode](#provider_linode) (2.13.0)

- <a name="provider_random"></a> [random](#provider_random) (3.6.0)

#### Required Inputs

The following input variables are required:

##### <a name="input_cloud_init_secrets"></a> [cloud_init_secrets](#input_cloud_init_secrets)

Description: Cloud-init secrets

Type:

```hcl
object({
        ubuntu_advantage_token = string
        github_username = string
    })
```

##### <a name="input_linode_config"></a> [linode_config](#input_linode_config)

Description: Configuration for Linode services.

Type:

```hcl
object({
        # Linode account configuration
        email        = string // Linode email address

        # Linode instance configuration
        region           = string // Linode region
        type             = string // Linode instance type
        image            = string // Linode image
        tags             = list(string) // Linode tags

        # Linode domain configuration
        domain           = string // Linode domain
        domain_ttl       = number // Linode domain TTL
    })
```

##### <a name="input_linode_count"></a> [linode_count](#input_linode_count)

Description: Number of Linode instances

Type: `number`

##### <a name="input_linode_label"></a> [linode_label](#input_linode_label)

Description: Linode instance label

Type: `string`

##### <a name="input_linode_token"></a> [linode_token](#input_linode_token)

Description: Linode API token

Type: `string`

#### Outputs

The following outputs are exported:

##### <a name="output_instance_ips"></a> [instance_ips](#output_instance_ips)

Description: Created instances

## Usage

Sample usage of this module is as shown below. For detailed info, look at inputs and outputs.

### Step 1

Create a `terraform.tfvars` file and update with:

```hcl
linode_token = "<linode-token>"

linode_count = 4
linode_label = "test"

linode_config = {
    email = "<linode-email>"
    region = "<linode-region>"
    type = "<linode-type>"
    image = "linode/ubuntu22.04"
    tags = [ "quickstart", "terraform" ]

    domain = "<linode-domain>"
    domain_ttl = 60

}

cloud_init_secrets = {
    ubuntu_advantage_token = "<ubuntu-advantage-token>"
    github_username = "<github-username>"
}

```

### Step 2

Verify your settings using the following command:

```bash
terraform init
terraform plan
```

### Step 3

Apply the changes

```bash
terraform apply
```

You will see a list of outputs similar to:

```bash
Apply complete! Resources: 13 added, 0 changed, 0 destroyed.

Outputs:

instance_ips = [
  "ssh://acc-user@test-0.fr-par.acc.domain.cloud",
  "ssh://acc-user@test-1.fr-par.acc.domain.cloud",
  "ssh://acc-user@test-2.fr-par.acc.domain.cloud",
  "ssh://acc-user@test-3.fr-par.acc.domain.cloud",
]
```

### Step 4

To clean up simply run:

`terraform destroy`

And confirm to remove all created resources.
<!-- END_TF_DOCS -->